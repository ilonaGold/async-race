(()=>{"use strict";var n={56:(n,t,e)=>{n.exports=function(n){var t=e.nc;t&&n.setAttribute("nonce",t)}},72:n=>{var t=[];function e(n){for(var e=-1,r=0;r<t.length;r++)if(t[r].identifier===n){e=r;break}return e}function r(n,r){for(var a={},o=[],s=0;s<n.length;s++){var c=n[s],d=r.base?c[0]+r.base:c[0],l=a[d]||0,h="".concat(d," ").concat(l);a[d]=l+1;var u=e(h),m={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==u)t[u].references++,t[u].updater(m);else{var g=i(m,r);r.byIndex=s,t.splice(s,0,{identifier:h,updater:g,references:1})}o.push(h)}return o}function i(n,t){var e=t.domAPI(t);return e.update(n),function(t){if(t){if(t.css===n.css&&t.media===n.media&&t.sourceMap===n.sourceMap&&t.supports===n.supports&&t.layer===n.layer)return;e.update(n=t)}else e.remove()}}n.exports=function(n,i){var a=r(n=n||[],i=i||{});return function(n){n=n||[];for(var o=0;o<a.length;o++){var s=e(a[o]);t[s].references--}for(var c=r(n,i),d=0;d<a.length;d++){var l=e(a[d]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}a=c}}},113:n=>{n.exports=function(n,t){if(t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}},249:(n,t,e)=>{e.d(t,{A:()=>s});var r=e(601),i=e.n(r),a=e(314),o=e.n(a)()(i());o.push([n.id,"@import url(https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Orbitron:wght@400;600&family=Racing+Sans+One&display=swap);"]),o.push([n.id,'/* CSS Variables */\n:root {\n  /* Colors */\n  --color-primary: #007bff;\n  --color-primary-dark: #0056b3;\n  --color-success: #4caf50;\n  --color-warning: #daa520;\n  --color-maroon: #800000;\n  --color-dark: #333;\n  --color-gray: #949090;\n  --color-light: #f5f5f5;\n  --color-white: #fff;\n  --color-border-primary: #ddd;\n  --color-border-secondary: #a4a1a1;\n  --color-background: #dee2e3;\n  --color-text: #2c3e50;\n  --color-text-light: #34495e;\n  --color-input-border: #ccc;\n  --color-shadow: rgba(0, 0, 0, 0.2);\n  --color-overlay: rgba(0, 0, 0, 0.8);\n  --color-hover: #f9f9f9;\n  --color-hover-dark: #e9e9e9;\n  --color-sort-inactive: #999;\n  --color-finish-line: #ff0000;\n  --color-disabled: #cccccc;\n\n  /* Animations */\n  --bounce-height: -10px;\n  --transition-base: 0.3s ease;\n  --transition-fast: 0.1s linear;\n  --transform-scale: 1.05;\n  --transform-scale-large: 1.5;\n\n  /* Fonts */\n  --font-primary: "Roboto", Arial, sans-serif;\n  --font-secondary: "Orbitron", sans-serif; /* For car names - techy feel */\n  --font-display: "Racing Sans One", cursive; /* For headers - racing theme */\n}\n\n/* ==== Base & Reset ==== */\n* {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n\nbody {\n  font-family: var(--font-primary);\n  font-size: 16px;\n  background-color: var(--color-background);\n  color: var(--color-dark);\n}\n\n/* ==== Shared Components ==== */\n\n.header {\n  padding: 1rem;\n  margin: 1rem;\n  background-color: var(--color-dark);\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-right: 0.5rem;\n}\n\n.nav {\n  display: flex;\n  gap: 1rem;\n  padding: 0.4rem 0.5rem;\n  flex-grow: 1;\n  justify-content: flex-start;\n}\n\n.nav__btn {\n  padding: 0.5rem 1.2rem;\n  border: none;\n  border-radius: 4px;\n  text-transform: uppercase;\n  font-weight: bold;\n  cursor: pointer;\n}\n\n.nav__btn.active {\n  background-color: var(--color-success);\n  color: var(--color-white);\n}\n\n/* Buttons */\n\nbutton {\n  padding: 0.5rem 1rem;\n  text-transform: uppercase;\n  border: none;\n  border-radius: 4px;\n  background-color: var(--color-primary);\n  color: var(--color-white);\n  transition: background-color 0.3s ease;\n  cursor: pointer;\n}\n\nbutton:hover {\n  background-color: var(--color-primary-dark);\n  transform: scale(var(--transform-scale));\n}\n\nbutton:focus {\n  outline: none;\n  box-shadow: 0 0 0 2px var(--color-primary-dark);\n}\n\nbutton:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n/* Shared buttons */\n\n#prev-btn,\n#next-btn {\n  padding: 0.5rem 0.9rem;\n  min-width: 5rem;\n}\n\n#page-num {\n  font-family: var(--font-primary);\n  font-size: 1.1rem;\n  font-weight: bold;\n  color: var(--color-text);\n  text-align: center;\n  display: inline-block;\n}\n\n/* Car Styles */\n\n.car {\n  position: absolute;\n  left: -6px;\n  bottom: -6px;\n  width: 100px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n  transition: transform 0.1s linear;\n}\n\n.car-name {\n  font-family: var(--font-secondary);\n  font-size: 0.9rem;\n  font-weight: 600;\n  letter-spacing: 0.04em;\n  color: var(--color-dark);\n  margin: 0.325rem 0.5rem;\n}\n\n/* ==== View Container ==== */\n\n.view-container {\n  max-width: 1400px;\n  min-height: 300px;\n  background-color: var(--color-gray);\n  border: 1px solid var(--color-border-secondary);\n  padding: 0.7rem 0.8rem 0.35rem;\n  margin: 1rem auto;\n  overflow-x: hidden;\n}\n\n.pagination {\n  display: flex;\n  gap: 0.625rem;\n  align-items: center;\n  margin: 0.625rem 0;\n  justify-content: flex-start;\n}\n\n/* ==== Garage Components ==== */\n\n.garage-container {\n  padding: 0.3125rem 0.625rem;\n  position: relative;\n  min-height: 600px; /* Ensure container has proper height for loader */\n}\n\n/* Garage Loader Styles */\n.garage-loader {\n  position: absolute !important;\n  top: 0 !important;\n  left: 0 !important;\n  width: 100% !important;\n  height: 100% !important;\n  display: flex !important;\n  align-items: center !important;\n  justify-content: center !important;\n  background: #949090 !important;\n  z-index: 9999 !important;\n  transition: opacity 0.3s;\n}\n\n.garage-loader-content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 1.2rem;\n}\n\n.garage-loader-text {\n  color: #ff0000 !important;\n  font-size: 1.5rem;\n  font-family: var(--font-secondary);\n  font-weight: 700;\n  margin-top: 1rem;\n  text-align: center;\n  letter-spacing: 0.02em;\n}\n\n.spinning-cog {\n  font-size: 6rem;\n  animation: spin 1.2s linear infinite;\n  color: #ff0000 !important;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n/* ==== Garage Header ==== */\nh2 {\n  font-family: var(--font-display);\n  font-size: 1.75rem;\n  font-weight: 700;\n  margin: 1.25rem 0;\n  text-transform: uppercase;\n  letter-spacing: 0.05em;\n}\n\n.controls {\n  display: flex;\n  flex-direction: column;\n  gap: 1.25rem;\n}\n\n.car-controls {\n  display: flex;\n  gap: 0.3125rem;\n  margin-right: 0.625rem;\n}\n\n.generate-btn {\n  padding: 0.5rem 1rem;\n  background: var(--color-success);\n  color: var(--color-white);\n  border: none;\n  border-radius: 0.25rem;\n  cursor: pointer;\n  transition: all var(--transition-base);\n}\n\n.generate-btn:disabled {\n  background: #cccccc;\n  cursor: not-allowed;\n  opacity: 0.7;\n}\n\n.create-form,\n.update-form,\n.race-controls {\n  display: flex;\n  gap: 0.625rem;\n  align-items: center;\n}\n\n#create-name,\n#update-name {\n  padding: 0.4rem 1rem;\n  border: 1px solid var(--color-input-border);\n  width: 210px;\n}\n\n#create-color,\n#update-color {\n  border: 1px solid var(--color-input-border);\n  width: 2.5rem;\n  height: 1.9375rem;\n}\n\n#create-btn,\n#update-btn {\n  padding: 0.5rem 1.2rem;\n}\n\n/* ==== Track Styles ==== */\n.track {\n  position: relative;\n  width: 100%;\n  max-width: 1400px;\n  min-width: 300px;\n  min-height: 100px;\n  border-bottom: 2px dashed #333;\n  padding: 0.9375rem 0;\n  margin: 0.625rem 0;\n  overflow: hidden;\n}\n\n/* Add scroll indicator for track */\n.track::after {\n  content: "→";\n  position: absolute;\n  right: 5px;\n  top: 50%;\n  transform: translateY(-50%);\n  font-size: 1.5rem;\n  color: var(--color-dark);\n  animation: pulse 1s infinite;\n  opacity: 0.5;\n  display: none; /* Hidden by default */\n}\n\n.finish-line {\n  position: absolute;\n  right: 7%;\n  top: 70%;\n  transform: translateY(-50%);\n  width: 3px;\n  height: 100%;\n  z-index: 10;\n  background-color: var(--color-finish-line);\n}\n\n/* ==== Winner Modal ==== */\n.winner-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.8);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  opacity: 0;\n  transition: opacity 0.3s ease;\n  z-index: 1000;\n  pointer-events: none;\n}\n\n.winner-overlay.visible {\n  opacity: 1;\n  pointer-events: auto;\n}\n\n.winner-modal {\n  background: linear-gradient(145deg, var(--color-white), var(--color-light));\n  border-radius: 20px;\n  padding: 1.875rem;\n  text-align: center;\n  box-shadow: 0 10px 25px var(--color-shadow);\n  transform: translateY(20px);\n  transition: transform 0.3s ease;\n  max-width: 400px;\n  width: 90%;\n}\n\n.winner-overlay.visible .winner-modal {\n  transform: translateY(0);\n}\n\n.winner-modal h2 {\n  font-family: var(--font-display);\n  font-size: 2.5rem;\n  color: var(--color-text);\n  margin-bottom: 1.25rem;\n  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n.winner-modal .winner-car {\n  transform: scale(1.1);\n  margin: 1.875rem 0;\n  animation: bounce 1s ease infinite;\n}\n\n.winner-modal p {\n  font-size: 1.5rem;\n  color: var(--color-text-light);\n  margin: 1.25rem 0;\n}\n\n.winner-modal .close-btn {\n  background: var(--color-warning);\n  color: var(--color-text);\n  padding: 0.75rem 1.875rem;\n  border-radius: 1.5625rem;\n  font-size: 1.1rem;\n  font-weight: bold;\n  border: none;\n  cursor: pointer;\n  transition: all var(--transition-base);\n  margin-top: 1.25rem;\n}\n\n.winner-modal .close-btn:hover {\n  transform: scale(1.1);\n  color: var(--color-maroon);\n}\n\n/* ==== Animations ==== */\n@keyframes bounce {\n  0%,\n  100% {\n    transform: scale(1.5) translateY(0);\n  }\n  50% {\n    transform: scale(1.5) translateY(-10px);\n  }\n}\n\n@keyframes pulse {\n  0%,\n  100% {\n    opacity: 0.5;\n  }\n  50% {\n    opacity: 1;\n  }\n}\n\n/* Confetti animation */\n.winner-modal::before {\n  content: "🎉";\n  position: absolute;\n  top: -20px;\n  left: 10px;\n  font-size: 2rem;\n  animation: confetti-left 1s ease infinite;\n}\n\n.winner-modal::after {\n  content: "🏆";\n  position: absolute;\n  top: -20px;\n  right: 10px;\n  font-size: 2rem;\n  animation: confetti-right 1s ease infinite;\n}\n\n@keyframes confetti-left {\n  0%,\n  100% {\n    transform: translateY(0) rotate(0);\n  }\n  50% {\n    transform: translateY(-15px) rotate(-15deg);\n  }\n}\n\n@keyframes confetti-right {\n  0%,\n  100% {\n    transform: translateY(0) rotate(0);\n  }\n  50% {\n    transform: translateY(-15px) rotate(15deg);\n  }\n}\n\n/* ==== Winners Table ==== */\n.winners-container {\n  padding: 1.25rem 0.625rem;\n}\n\n.winners-table {\n  width: 100%;\n  border-collapse: collapse;\n  font-size: 1.2rem;\n  margin: 1.25rem 0;\n  background: var(--color-white);\n  box-shadow: 0px 1px 3px var(--color-shadow);\n}\n\n.winners-table th,\n.winners-table td {\n  padding: 0.75rem 1.5rem;\n  text-align: left;\n  border-bottom: 1px solid var(--color-border-primary);\n}\n\n.winners-table th {\n  background-color: var(--color-light);\n  font-weight: bold;\n}\n\n.winners-table td:first-child {\n  font-weight: bold;\n  color: var(--color-text);\n}\n\n.winners-table th.sortable {\n  position: relative;\n  min-width: 110px;\n  padding-right: 2.5rem;\n  cursor: pointer;\n}\n\n.winners-table th.sortable::after {\n  position: absolute;\n  right: 0.75rem;\n  top: 50%;\n  transform: translateY(-50%);\n  content: "↕";\n  visibility: visible;\n  width: 0.75rem;\n  text-align: center;\n  color: var(--color-sort-inactive);\n}\n\n.winners-table th.sortable.sorted-asc::after,\n.winners-table th.sortable.sorted-desc::after {\n  color: var(--color-dark);\n}\n\n.winners-table tr:hover {\n  background-color: var(--color-hover);\n}\n\n.winners-table th.sortable:hover {\n  background-color: var(--color-hover-dark);\n}\n\n.winners-table th.sortable::after {\n  transition: color var(--transition-base);\n}\n\n.car-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 50px;\n  transform: scale(1.5);\n  margin-top: 8px;\n}\n\n/* ==== Media Queries ==== */\n@media (max-width: 1200px) {\n  .finish-line {\n    right: 10%;\n  }\n}\n\n@media (max-width: 768px) {\n  .header {\n    padding: 0.7rem;\n    margin: 0.7rem;\n  }\n\n  .nav__btn {\n    padding: 0.4rem 0.8rem;\n    font-size: 0.9rem;\n  }\n\n  .car {\n    width: 80px;\n    height: 32px;\n  }\n\n  .car-name {\n    font-size: 1rem;\n  }\n\n  .car-controls button {\n    padding: 0.3rem 0.6rem;\n    font-size: 0.8rem;\n  }\n\n  .controls,\n  .create-form,\n  .update-form {\n    gap: 0.5rem;\n  }\n\n  #create-name,\n  #update-name {\n    width: 100%;\n    max-width: 215px;\n  }\n\n  .finish-line {\n    right: 15%;\n  }\n\n  .track::after {\n    display: block;\n  }\n\n  .winners-table {\n    display: block;\n    overflow-x: auto;\n  }\n\n  .winners-table th,\n  .winners-table td {\n    font-size: 0.9rem;\n    padding: 0.5rem 0.75rem;\n  }\n}\n\n@media (max-width: 500px) {\n  .car-name {\n    font-size: 0.9rem;\n  }\n\n  .create-form,\n  .update-form {\n    gap: 0.4rem;\n  }\n\n  .winner-modal h2 {\n    font-size: 2rem;\n  }\n\n  .winner-modal p {\n    font-size: 1.2rem;\n  }\n\n  .winner-modal .winner-car {\n    transform: scale(0.75);\n  }\n}\n',""]);const s=o},314:n=>{n.exports=function(n){var t=[];return t.toString=function(){return this.map((function(t){var e="",r=void 0!==t[5];return t[4]&&(e+="@supports (".concat(t[4],") {")),t[2]&&(e+="@media ".concat(t[2]," {")),r&&(e+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),e+=n(t),r&&(e+="}"),t[2]&&(e+="}"),t[4]&&(e+="}"),e})).join("")},t.i=function(n,e,r,i,a){"string"==typeof n&&(n=[[null,n,void 0]]);var o={};if(r)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(o[c]=!0)}for(var d=0;d<n.length;d++){var l=[].concat(n[d]);r&&o[l[0]]||(void 0!==a&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=a),e&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=e):l[2]=e),i&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=i):l[4]="".concat(i)),t.push(l))}},t}},540:n=>{n.exports=function(n){var t=document.createElement("style");return n.setAttributes(t,n.attributes),n.insert(t,n.options),t}},601:n=>{n.exports=function(n){return n[1]}},659:n=>{var t={};n.exports=function(n,e){var r=function(n){if(void 0===t[n]){var e=document.querySelector(n);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(n){e=null}t[n]=e}return t[n]}(n);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(e)}},825:n=>{n.exports=function(n){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=n.insertStyleElement(n);return{update:function(e){!function(n,t,e){var r="";e.supports&&(r+="@supports (".concat(e.supports,") {")),e.media&&(r+="@media ".concat(e.media," {"));var i=void 0!==e.layer;i&&(r+="@layer".concat(e.layer.length>0?" ".concat(e.layer):""," {")),r+=e.css,i&&(r+="}"),e.media&&(r+="}"),e.supports&&(r+="}");var a=e.sourceMap;a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(r,n,t.options)}(t,n,e)},remove:function(){!function(n){if(null===n.parentNode)return!1;n.parentNode.removeChild(n)}(t)}}}}},t={};function e(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={id:r,exports:{}};return n[r](a,a.exports,e),a.exports}e.n=n=>{var t=n&&n.__esModule?()=>n.default:()=>n;return e.d(t,{a:t}),t},e.d=(n,t)=>{for(var r in t)e.o(t,r)&&!e.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:t[r]})},e.o=(n,t)=>Object.prototype.hasOwnProperty.call(n,t),e.nc=void 0;var r=e(72),i=e.n(r),a=e(825),o=e.n(a),s=e(659),c=e.n(s),d=e(56),l=e.n(d),h=e(540),u=e.n(h),m=e(113),g=e.n(m),p=e(249),f={};f.styleTagTransform=g(),f.setAttributes=l(),f.insert=c().bind(null,"head"),f.domAPI=o(),f.insertStyleElement=u(),i()(p.A,f),p.A&&p.A.locals&&p.A.locals;var v=function(n,t,e,r){return new(e||(e=Promise))((function(i,a){function o(n){try{c(r.next(n))}catch(n){a(n)}}function s(n){try{c(r.throw(n))}catch(n){a(n)}}function c(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(o,s)}c((r=r.apply(n,t||[])).next())}))};class y{static getCars(n){return v(this,arguments,void 0,(function*(n,t=7){const e=yield fetch(`${y.BASE_URL}/garage?_page=${n}&_limit=${t}`);if(!e.ok)throw new Error(`Failed to fetch cars: ${e.status}`);const r=yield fetch(`${y.BASE_URL}/garage`),i=yield r.json();return{cars:yield e.json(),total:i.length}}))}static getCarById(n){return v(this,void 0,void 0,(function*(){const t=yield fetch(`${y.BASE_URL}/garage/${n}`);if(!t.ok)throw new Error(`Car ${n} not found`);return t.json()}))}static createCar(n){return v(this,void 0,void 0,(function*(){return(yield fetch(`${y.BASE_URL}/garage`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).json()}))}static deleteCar(n){return v(this,void 0,void 0,(function*(){return yield fetch(`${y.BASE_URL}/garage/${n}`,{method:"DELETE"})}))}static updateCar(n,t){return v(this,void 0,void 0,(function*(){return(yield fetch(`${y.BASE_URL}/garage/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json()}))}static controlEngine(n,t){return v(this,void 0,void 0,(function*(){return(yield fetch(`${y.BASE_URL}/engine?id=${n}&status=${t}`,{method:"PATCH"})).json()}))}static switchToDrive(n){return v(this,void 0,void 0,(function*(){return(yield fetch(`${y.BASE_URL}/engine?id=${n}&status=drive`,{method:"PATCH"})).json()}))}static getWinners(n){return v(this,arguments,void 0,(function*(n,t=10,e,r){const i=yield fetch(`${y.BASE_URL}/winners?_page=${n}&_limit=${t}&_sort=${e}&_order=${r}`);if(!i.ok)return{items:[],count:0};const a=yield i.json(),o=Number(i.headers.get("X-Total-Count"))||0;return console.log("API Response:",{items:a,count:o}),{items:a,count:o}}))}static getWinner(n){return v(this,void 0,void 0,(function*(){const t=yield fetch(`${this.BASE_URL}/winners/${n}`);return 404===t.status?null:t.json()}))}static saveWinner(n){return v(this,void 0,void 0,(function*(){try{const t=yield this.getWinner(n.id).catch((()=>null));t?yield this.updateWinner(n.id,{wins:t.wins+1,time:Math.min(t.time,n.time)}):yield this.createWinner({id:n.id,wins:1,time:n.time})}catch(n){throw console.error("Failed to save winner:",n),n}}))}static createWinner(n){return v(this,void 0,void 0,(function*(){const t=yield fetch(`${this.BASE_URL}/winners`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok)throw new Error(`Failed to create winner: ${t.statusText}`);return t.json()}))}static updateWinner(n,t){return v(this,void 0,void 0,(function*(){const e=yield fetch(`${this.BASE_URL}/winners/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok)throw new Error(`Failed to update winner: ${e.statusText}`);return e.json()}))}static deleteWinner(n){return v(this,void 0,void 0,(function*(){yield fetch(`${y.BASE_URL}/winners/${n}`,{method:"DELETE"})}))}static generateRandomCars(n){return v(this,void 0,void 0,(function*(){const t=Array.from({length:n},(()=>({name:this.getRandomCarName(),color:this.getRandomColor()}))).map((n=>this.createCar(n)));return Promise.all(t)}))}static getRandomCarName(){const n=["Tesla","Ford","Porsche","BMW","Audi","Mercedes","Toyota"],t=["Model S","Mustang","911","M5","A4","C-Class","Supra"];return`${n[Math.floor(Math.random()*n.length)]} ${t[Math.floor(Math.random()*t.length)]}`}static getRandomColor(){return`#${Math.floor(16777215*Math.random()).toString(16).padStart(6,"0")}`}}y.BASE_URL="https://async-race-api-fvw6.onrender.com";const b=y;class w{constructor(n,t,e){var r,i;if(this.element=n,this.car=t,this.finished=!1,this.isRunning=!1,this.currentPosition=0,this.engineStarted=!1,this.distance=0,!n)throw new Error(`Car element for car ${t.id} not provided`);this.trackElement=this.element.closest(".track"),this.finishElement=null!==(i=null===(r=this.trackElement)||void 0===r?void 0:r.querySelector(".finish-line"))&&void 0!==i?i:null,this.trackLength=e,this.calculateTrackLength(),window.addEventListener("resize",this.handleResize.bind(this))}handleResize(){this.calculateTrackLength(),this.isRunning&&this.animateFromCurrentPosition()}calculateTrackLength(){if(this.trackElement&&this.finishElement){const n=this.trackElement.getBoundingClientRect(),t=this.finishElement.getBoundingClientRect();this.trackLength=t.left-n.left}}animateFromCurrentPosition(){if(!this.isRunning)return;const n=this.currentPosition/this.trackLength,t=(this.trackLength-this.currentPosition)/this.distance*(this.distance/(this.distance/this.trackLength));this.animate(t,n)}hasFinished(){return this.finished}start(){return n=this,t=void 0,r=function*(){if(!this.isRunning)try{this.isRunning=!0,this.finished=!1,this.currentPosition=0,this.engineStarted=!1;const{velocity:n,distance:t}=yield b.controlEngine(this.car.id,"started");this.distance=t,this.engineStarted=!0,this.animate(t/n);try{yield b.switchToDrive(this.car.id)}catch(n){console.warn(`Drive mode warning for car ${this.car.id}:`,n),this.isRunning=!1}}catch(n){console.error("Failed to start car:",n),this.stop(!1)}},new((e=void 0)||(e=Promise))((function(i,a){function o(n){try{c(r.next(n))}catch(n){a(n)}}function s(n){try{c(r.throw(n))}catch(n){a(n)}}function c(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(o,s)}c((r=r.apply(n,t||[])).next())}));var n,t,e,r}animate(n,t=0){const e=performance.now(),r=i=>{if(!this.isRunning||!this.engineStarted)return void this.stop(this.currentPosition>0);const a=t+(i-e)/n;this.currentPosition=Math.min(this.trackLength,this.trackLength*a),this.element.style.transform=`translateX(${this.currentPosition}px)`,a<1?this.animationId=requestAnimationFrame(r):(this.finished=!0,this.isRunning=!1,this.stop(!0))};this.animationId=requestAnimationFrame(r)}stop(n=!1){window.removeEventListener("resize",this.handleResize),this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=void 0),this.isRunning=!1,this.engineStarted=!1,this.element.style.transition="transform 0.5s ease-out",n||(this.currentPosition=0,this.element.style.transform="translateX(0)",this.finished=!1)}}var x=function(n,t,e,r){return new(e||(e=Promise))((function(i,a){function o(n){try{c(r.next(n))}catch(n){a(n)}}function s(n){try{c(r.throw(n))}catch(n){a(n)}}function c(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(o,s)}c((r=r.apply(n,t||[])).next())}))};const C=class{constructor(){this.isLoading=!1,this.currentPage=1,this.cars=[],this.carAnimations=new Map,this.TRACK_LENGTH=1e3,this.totalCars=0,this.carsPerPage=7,this.isRacing=!1,this.currentOverlay=null,this.tracksContainer=null}getCar(n){return this.cars.find((t=>t.id===n))}getCurrentPageCars(){return this.cars}renderCreateForm(){return'\n      <div class="create-form">\n        <input type="text" id="create-name" placeholder="Car name" required>\n        <input type="color" id="create-color" value="#ff0000">\n        <button id="create-btn">Create</button>\n      </div>\n    '}renderUpdateForm(){return'\n      <div class="update-form">\n        <input type="text" id="update-name" placeholder="Car name" required>\n        <input type="color" id="update-color" value="#ff0000">\n        <button id="update-btn" disabled>Update</button>\n      </div>\n    '}renderRaceControls(){return'\n      <div class="race-controls">\n        <button id="race-btn">Race All</button>\n        <button id="reset-btn" disabled>Reset All</button>\n        <button id="generate-btn">Generate Cars</button>\n      </div>\n    '}renderPagination(){const n=this.currentPage*this.carsPerPage<this.totalCars;return`\n      <div class="pagination">\n        <button id="prev-btn" ${1===this.currentPage?"disabled":""}>← Prev</button>\n        <span id="page-num">Page #${this.currentPage}</span>\n        <button id="next-btn" ${n?"":"disabled"}>Next →</button>\n      </div>\n    `}render(){return x(this,void 0,void 0,(function*(){this.cleanupAnimations();const n=document.createElement("div");n.className="garage-container";const t=document.createElement("div");return t.className="garage-loader",t.innerHTML='\n      <div class="garage-loader-content">\n        <div class="spinning-cog" style="color: #ff0000 !important;">⚙</div>\n        <div class="garage-loader-text">Warming up the engines...</div>\n      </div>\n    ',n.appendChild(t),this.isLoading=!0,setTimeout((()=>x(this,void 0,void 0,(function*(){var e,r;yield new Promise((n=>setTimeout(n,3e3)));try{const{cars:i,total:a}=yield b.getCars(this.currentPage,this.carsPerPage);this.cars=i,this.totalCars=a,this.isLoading=!1,t.remove();const o=document.createElement("div");o.className="controls",o.innerHTML=this.renderCreateForm()+this.renderUpdateForm()+this.renderRaceControls(),n.appendChild(o);const s=document.createElement("h2");s.textContent=`Garage (${this.totalCars})`,n.appendChild(s);const c=document.createElement("div");c.innerHTML=this.renderPagination(),n.appendChild(c.firstElementChild);const d=document.createElement("div");d.className="tracks",d.innerHTML=this.cars.map((n=>this.renderCarTrack(n))).join(""),n.appendChild(d),null===(e=n.querySelector("#race-btn"))||void 0===e||e.addEventListener("click",(()=>this.startRace())),null===(r=n.querySelector("#reset-btn"))||void 0===r||r.addEventListener("click",(()=>this.resetRace()))}catch(e){this.isLoading=!1,t.remove(),console.error("Error loading garage:",e);const r=document.createElement("p");r.textContent="Error loading garage data",n.appendChild(r)}}))),100),n.addEventListener("click",(n=>{const t=n.target,e=Number(t.getAttribute("data-car-id"));t.classList.contains("start-btn")?this.startCar(e):t.classList.contains("stop-btn")&&this.stopCar(e)})),n}))}cleanupAnimations(){this.carAnimations.forEach((n=>n.stop())),this.carAnimations.clear()}renderCarTrack(n){const t=this.carAnimations.get(n.id);t&&(t.stop(),this.carAnimations.delete(n.id));const e=`\n      <div class="track" data-car-id="${n.id}">\n        <div class="car-controls">\n          <button class="select-btn" data-car-id="${n.id}">Select</button>\n          <button class="start-btn" data-car-id="${n.id}">Start</button>\n          <button class="stop-btn" data-car-id="${n.id}" disabled>Stop</button>\n          <button class="delete-btn" data-car-id="${n.id}">Remove</button>\n          <span class="car-name">${n.name}</span>\n        </div>\n        <div class="car" style="color: ${n.color}">\n          ${this.getCarSVG()}\n        </div>\n        <div class="finish-line"></div>\n      </div>\n    `;return setTimeout((()=>{const t=document.querySelector(`[data-car-id="${n.id}"] .car`);if(t instanceof HTMLElement){const e=t.closest(".track"),r=null==e?void 0:e.querySelector(".finish-line"),i=r?r.getBoundingClientRect().left-t.getBoundingClientRect().left:this.TRACK_LENGTH;this.carAnimations.set(n.id,new w(t,n,i))}}),0),e}getCarSVG(){return'<svg width="100" height="40" viewBox="0 0 100 40">\n      <rect x="10" y="15" width="80" height="10" fill="currentColor"/>\n      <rect x="20" y="5" width="60" height="10" fill="currentColor"/>\n      <circle cx="25" cy="30" r="5" fill="#333"/>\n      <circle cx="75" cy="30" r="5" fill="#333"/>\n    </svg>'}nextPage(){return x(this,void 0,void 0,(function*(){const n=this.currentPage+1,{cars:t,total:e}=yield b.getCars(n,this.carsPerPage);n*this.carsPerPage<=e&&(this.currentPage=n,this.cars=t,this.totalCars=e)}))}prevPage(){return x(this,void 0,void 0,(function*(){if(this.currentPage>1){this.currentPage--;const{cars:n,total:t}=yield b.getCars(this.currentPage,this.carsPerPage);this.cars=n,this.totalCars=t}}))}getCurrentPage(){return this.currentPage}removeCar(n){const t=this.cars.findIndex((t=>t.id===n));if(-1===t)return;this.cars.splice(t,1),this.totalCars--;const e=document.querySelector(`[data-car-id="${n}"]`);e&&e.remove();const r=document.querySelector("h2");r&&(r.textContent=`Garage (${this.totalCars})`);const i=document.getElementById("prev-btn"),a=document.getElementById("next-btn");i&&(i.disabled=1===this.currentPage),a&&(a.disabled=this.currentPage*this.carsPerPage>=this.totalCars)}updateTracksDisplay(){this.tracksContainer=document.querySelector(".tracks"),this.tracksContainer&&(this.tracksContainer.innerHTML=this.cars.map((n=>this.renderCarTrack(n))).join(""))}startCar(n){return x(this,void 0,void 0,(function*(){const t=this.carAnimations.get(n);if(t){const e=document.querySelector(`[data-car-id="${n}"] .start-btn`),r=document.querySelector(`[data-car-id="${n}"] .stop-btn`);e.disabled=!0,r.disabled=!1,yield t.start()}}))}stopCar(n){const t=this.carAnimations.get(n);if(t){const e=document.querySelector(`[data-car-id="${n}"] .start-btn`),r=document.querySelector(`[data-car-id="${n}"] .stop-btn`);e.disabled=!1,r.disabled=!0,t.stop()}}startRace(){return x(this,void 0,void 0,(function*(){if(this.isRacing)return;this.removeOverlay(!1),this.isRacing=!0;const n=document.getElementById("race-btn"),t=document.getElementById("reset-btn");n&&(n.disabled=!0),t&&(t.disabled=!1);const e=this.cars.map((n=>{const t=this.carAnimations.get(n.id);if(t){const e=document.querySelector(`[data-car-id="${n.id}"] .start-btn`),r=document.querySelector(`[data-car-id="${n.id}"] .stop-btn`);return e&&(e.disabled=!0),r&&(r.disabled=!1),t.start()}return Promise.resolve()}));try{yield Promise.race(e);const n=yield new Promise((n=>{const t=()=>{const e=this.cars.find((n=>{const t=this.carAnimations.get(n.id);return null==t?void 0:t.hasFinished()}));e?n(e):this.isRacing?setTimeout(t,100):n(void 0)};t()}));n&&this.announceWinner(n)}catch(n){console.error("Race error:",n)}}))}resetRace(){if(this.isRacing){this.isRacing=!1;const n=document.getElementById("race-btn"),t=document.getElementById("reset-btn");n&&(n.disabled=!1),t&&(t.disabled=!0),this.cars.forEach((n=>{const t=this.carAnimations.get(n.id);t&&t.stop(!1)}))}}announceWinner(n){return x(this,void 0,void 0,(function*(){var t;try{const e=5*Math.random()+1;yield b.saveWinner({id:n.id,wins:1,time:parseFloat(e.toFixed(2))});const r=document.createElement("div");r.className="winner-overlay visible",r.innerHTML=`\n      <div class="winner-modal">\n        <h2>🏆 Winner!</h2>\n        <div class="winner-car" style="color: ${n.color}">\n          ${this.getCarSVG()}\n        </div>\n        <p>${n.name}</p>\n        <button class="close-btn">Close</button>\n      </div>\n    `,this.currentOverlay=r,document.body.appendChild(r),null===(t=r.querySelector(".close-btn"))||void 0===t||t.addEventListener("click",(()=>{this.removeOverlay()}))}catch(n){console.error("Failed to save winner:",n)}}))}removeOverlay(n=!0){this.currentOverlay&&(this.currentOverlay.remove(),this.currentOverlay=null),n&&this.resetRace()}};var E=function(n,t,e,r){return new(e||(e=Promise))((function(i,a){function o(n){try{c(r.next(n))}catch(n){a(n)}}function s(n){try{c(r.throw(n))}catch(n){a(n)}}function c(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(o,s)}c((r=r.apply(n,t||[])).next())}))};class P{constructor(){this.winners=[],this.currentPage=1,this.ITEMS_PER_PAGE=10,this.totalWinners=0,this.sortBy="time",this.sortOrder="ASC",this.container=document.createElement("div"),this.container.className="winners-container",this.container.innerHTML="<p>Loading winners...</p>"}render(){return E(this,void 0,void 0,(function*(){return yield this.loadWinners(),this.container}))}prevPage(){this.currentPage>1&&this.currentPage--}nextPage(){this.currentPage*this.ITEMS_PER_PAGE<this.totalWinners&&this.currentPage++}setSort(n){this.sortBy===n?this.sortOrder="ASC"===this.sortOrder?"DESC":"ASC":(this.sortBy=n,this.sortOrder="ASC"),this.container.querySelectorAll(".sortable").forEach((t=>{const e=t.getAttribute("data-sort");t.classList.toggle("sorted",e===n)})),this.loadWinners()}loadWinners(){return E(this,void 0,void 0,(function*(){try{const n=yield b.getWinners(this.currentPage,this.ITEMS_PER_PAGE,this.sortBy,this.sortOrder),{items:t,count:e}=n;this.totalWinners=Number(e),this.winners=yield Promise.all(t.map((n=>E(this,void 0,void 0,(function*(){try{const t=yield b.getCarById(n.id);return{id:n.id,wins:n.wins,time:Number(n.time),car:{id:t.id,name:t.name,color:t.color}}}catch(t){return console.error(`Failed to load car ${n.id}:`,t),null}}))))).then((n=>n.filter(Boolean))),this.totalWinners=e,this.updateView()}catch(n){console.error("Failed to load winners:",n),this.container.innerHTML="<p>Error loading winners</p>"}}))}updateView(){this.container.innerHTML=`\n      <h2>Winners (${this.totalWinners})</h2>\n      <table class="winners-table">\n        <thead>\n          <tr>\n            <th>№</th>\n            <th>Car</th>\n            <th>Name</th>\n            <th class="sortable ${"wins"===this.sortBy?"sorted":""}" data-sort="wins">\n              Wins ${this.getSortArrow("wins")}\n            </th>\n            <th class="sortable ${"time"===this.sortBy?"sorted":""}" data-sort="time">\n              Best Time (s) ${this.getSortArrow("time")}\n            </th>\n          </tr>\n        </thead>\n        <tbody>\n          ${this.winners.map(((n,t)=>this.renderWinnerRow(n,t))).join("")}\n        </tbody>\n      </table>\n      ${this.renderPagination()}\n    `,this.addEventListeners()}getSortArrow(n){return this.sortBy===n?"ASC"===this.sortOrder?"↑":"↓":""}renderPagination(){const n=this.currentPage>1,t=this.currentPage*this.ITEMS_PER_PAGE<this.totalWinners;return`\n      <div class="pagination">\n        <button id="winners-prev" ${n?"":"disabled"}>← Prev</button>\n        <span id="page-num">Page #${this.currentPage}</span>\n        <button id="winners-next" ${t?"":"disabled"}>Next →</button>\n        <button id="refresh-winners">Refresh</button>\n        </div>\n    `}renderWinnerRow(n,t){const e=(this.currentPage-1)*this.ITEMS_PER_PAGE+t+1,r=Number(n.time).toFixed(2);return`\n      <tr>\n        <td>${e}</td>\n        <td>\n          <div class="car-icon" style="color: ${n.car.color}">\n            ${this.getCarSVG()}\n          </div>\n        </td>\n        <td>${n.car.name}</td>\n        <td>${n.wins}</td>\n        <td>${r}</td>\n      </tr>\n    `}getCarSVG(){return'<svg width="50" height="20" viewBox="0 0 100 40">\n      <rect x="10" y="15" width="80" height="10" fill="currentColor"/>\n      <rect x="20" y="5" width="60" height="10" fill="currentColor"/>\n      <circle cx="25" cy="30" r="5" fill="#333"/>\n      <circle cx="75" cy="30" r="5" fill="#333"/>\n    </svg>'}addEventListeners(){const n=this.container.querySelectorAll(".sortable");n.forEach((t=>{t.addEventListener("click",(()=>{const e=t.dataset.sort;n.forEach((n=>{n.classList.remove("sorted-asc","sorted-desc")})),this.sortBy===e?this.sortOrder="ASC"===this.sortOrder?"DESC":"ASC":(this.sortBy=e,this.sortOrder="ASC"),t.classList.add("ASC"===this.sortOrder?"sorted-asc":"sorted-desc"),this.loadWinners()}))}));const t=this.container.querySelector("#winners-prev"),e=this.container.querySelector("#winners-next");null==t||t.addEventListener("click",(()=>E(this,void 0,void 0,(function*(){this.currentPage>1&&(this.currentPage--,yield this.loadWinners())})))),null==e||e.addEventListener("click",(()=>E(this,void 0,void 0,(function*(){const n=Math.ceil(this.totalWinners/this.ITEMS_PER_PAGE);console.log("Current page:",this.currentPage,"Total pages:",n),this.currentPage<n&&(this.currentPage++,yield this.loadWinners())}))));const r=this.container.querySelector("#refresh-winners");null==r||r.addEventListener("click",(()=>E(this,void 0,void 0,(function*(){try{yield this.loadWinners()}catch(n){console.error("Error refreshing winners:",n)}}))))}refresh(){return E(this,void 0,void 0,(function*(){yield this.loadWinners()}))}}var S=function(n,t,e,r){return new(e||(e=Promise))((function(i,a){function o(n){try{c(r.next(n))}catch(n){a(n)}}function s(n){try{c(r.throw(n))}catch(n){a(n)}}function c(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(o,s)}c((r=r.apply(n,t||[])).next())}))};new class{constructor(n){this.garageView=new C,this.winnersView=new P,this.selectedCarId=null,this.root=document.getElementById(n),this.renderBaseLayout(),this.viewContainer=document.getElementById("view-container"),this.setupNavigation(),this.loadView("garage")}renderBaseLayout(){this.root.innerHTML='\n      <header class="header">\n        <nav class="nav">\n          <button class="nav__btn active" data-view="garage">To Garage</button>\n          <button class="nav__btn" data-view="winners">To Winners</button>\n        </nav>\n      </header>\n      <main id="view-container" class="view-container"></main>\n    '}setupNavigation(){document.querySelectorAll(".nav__btn").forEach((n=>{n.addEventListener("click",(()=>{const t=n.getAttribute("data-view");t&&(document.querySelectorAll(".nav__btn").forEach((n=>n.classList.remove("active"))),n.classList.add("active"),this.loadView(t))}))}))}loadView(n){return S(this,void 0,void 0,(function*(){var t,e;if(this.viewContainer.innerHTML="","garage"===n){const n=yield this.garageView.render();this.viewContainer.appendChild(n),this.setupGarageEvents(),null===(t=n.querySelector("#race-btn"))||void 0===t||t.addEventListener("click",(()=>this.handleRaceAll())),null===(e=n.querySelector("#reset-btn"))||void 0===e||e.addEventListener("click",(()=>this.handleResetAll()))}else if("winners"===n){const n=yield this.winnersView.render();this.viewContainer.appendChild(n)}}))}setupWinnersEvents(){var n,t;null===(n=document.getElementById("winners-prev"))||void 0===n||n.addEventListener("click",(()=>{this.winnersView.prevPage(),this.loadView("winners")})),null===(t=document.getElementById("winners-next"))||void 0===t||t.addEventListener("click",(()=>{this.winnersView.nextPage(),this.loadView("winners")})),document.querySelectorAll(".sortable").forEach((n=>{n.addEventListener("click",(()=>{const t=n.getAttribute("data-sort");this.winnersView.setSort(t),this.loadView("winners")}))}))}setupGarageEvents(){var n,t,e,r,i;try{let a;null===(n=document.getElementById("create-btn"))||void 0===n||n.addEventListener("click",this.handleCreateCar.bind(this)),null===(t=document.getElementById("update-btn"))||void 0===t||t.addEventListener("click",this.handleUpdateCar.bind(this));const o=n=>S(this,void 0,void 0,(function*(){clearTimeout(a),a=setTimeout((()=>S(this,void 0,void 0,(function*(){"prev"===n?yield this.garageView.prevPage():yield this.garageView.nextPage(),yield this.loadView("garage")}))),300)}));null===(e=document.getElementById("prev-btn"))||void 0===e||e.addEventListener("click",(()=>o("prev"))),null===(r=document.getElementById("next-btn"))||void 0===r||r.addEventListener("click",(()=>o("next"))),null===(i=document.getElementById("generate-btn"))||void 0===i||i.addEventListener("click",this.handleGenerateCars.bind(this)),document,this.viewContainer.addEventListener("click",(n=>S(this,void 0,void 0,(function*(){const t=n.target;if(!t.dataset.carId)return;const e=Number(t.dataset.carId);t.classList.contains("select-btn")?this.handleSelectCar(e):t.classList.contains("delete-btn")&&(yield this.handleDeleteCar(e))}))))}catch(n){console.error("Failed to set up garage events:",n)}}handleCreateCar(){return S(this,void 0,void 0,(function*(){const n=document.getElementById("create-name"),t=document.getElementById("create-color");if(n.value.trim())try{yield b.createCar({name:n.value.trim(),color:t.value}),n.value="",t.value="#ff0000",yield this.loadView("garage")}catch(n){console.error("Failed to create car:",n),alert("Failed to create car")}else alert("Please enter a car name")}))}handleSelectCar(n){this.selectedCarId=n;const t=this.garageView.getCar(n);if(t){const n=document.getElementById("update-name"),e=document.getElementById("update-color"),r=document.getElementById("update-btn");n.value=t.name,e.value=t.color,r.disabled=!1}}handleDeleteCar(n){return S(this,void 0,void 0,(function*(){try{if((yield b.deleteCar(n)).ok){this.selectedCarId===n&&this.resetUpdateForm();const t=this.garageView.getCurrentPageCars().length;this.garageView.removeCar(n),1===t&&(this.garageView.getCurrentPage()>1&&(yield this.garageView.prevPage()),yield this.loadView("garage"))}}catch(n){console.error("Failed to delete car:",n),alert("Failed to delete car. Please try again.")}}))}resetUpdateForm(){const n=document.getElementById("update-name"),t=document.getElementById("update-color"),e=document.getElementById("update-btn");n.value="",t.value="#ff0000",e.disabled=!0,this.selectedCarId=null}handleUpdateCar(){return S(this,void 0,void 0,(function*(){if(!this.selectedCarId)return;const n=document.getElementById("update-name"),t=document.getElementById("update-color");if(n.value.trim())try{yield b.updateCar(this.selectedCarId,{name:n.value.trim(),color:t.value}),this.resetUpdateForm(),yield this.loadView("garage")}catch(n){console.error("Failed to update car:",n),alert("Failed to update car")}else alert("Please enter a car name")}))}handleRaceAll(){return S(this,void 0,void 0,(function*(){try{yield this.garageView.startRace()}catch(n){console.error("Race failed:",n)}}))}handleResetAll(){return S(this,void 0,void 0,(function*(){this.garageView.resetRace()}))}handleGenerateCars(){return S(this,void 0,void 0,(function*(){try{const n=document.getElementById("generate-btn");n.disabled=!0,n.textContent="Generating...",yield b.generateRandomCars(100),yield this.loadView("garage"),n.disabled=!1,n.textContent="Generate Cars"}catch(n){console.error("Failed to generate cars:",n),alert("Failed to generate cars")}}))}}("app")})();